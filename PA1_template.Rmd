---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## STEP 1 - Loading and preprocessing the data

plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext

```{r}
# Always set working diractory to Home
setwd("~")
# Make sure needed packages loaded
req.pkg <- c("ggplot2","dplyr","lubridate")
pkgs.not.installed <- req.pkg[!sapply(req.pkg, function(p) require(p, character.only=T))]
if (length(pkgs.not.installed)>0) install.packages(pkgs.not.installed, dependencies=TRUE)

library(ggplot2)
library(dplyr)
library(lubridate)

sessionInfo()

setwd("~")

if (!file.exists("data")) {
    dir.create("data")
}

## download and unzip file to ./data folder

## Download and load data
sourceUrl <- "http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
zipFile <- "./data/factivity.zip"  # file to be downloaded

# only download if zip file has not been downloaded before
if ( !file.exists(zipFile) ) {
    download.file(sourceUrl, zipFile)
}

# unzip the files (will do nothing if we previously did this)
filepaths <- unzip(zipFile,exdir = "./data")

activity <- read.csv("./data/activity.csv")
```

## What is mean total number of steps taken per day?

```{r}

activity_by_day <- activity %>% select (date,steps) %>% 
        filter(!is.na(steps)) %>% 
             group_by (date) %>% 
                summarise(totalstepsperday= sum(steps))

summary (activity_by_day)


hist(activity_by_day$totalstepsperday,
     breaks=seq(0,25000,by=2500),
         ylim=c(0,20),
            col="blue",
                main="Histogram of daily steps",
                    xlab="Steps",
                        ylab="Frequency",
                            border="red")
# g <- ggplot(activity_by_day,aes(x = totalstepsperday)) +
#   ggtitle("Histogram of daily steps") +
#   xlab("Steps (binwidth 2000)") +
#   scale_fill_brewer() +
#   geom_histogram(binwidth = 1000,fill="#3399FF",colour="black")
#g


```


## STEP 2 - What is the average daily activity pattern?
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext

```{r}
activity_daily <- activity %>% select (interval,steps) %>% 
        filter(!is.na(steps)) %>% 
             group_by (interval) %>% 
                summarise(meandailysteps= mean(steps))

summary (activity_daily)

p <- ggplot(activity_daily, aes(x=interval, y=meandailysteps))
p + geom_line()

# calculate which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
maxstepsinterval <- activity_daily %>% slice(which.max(meandailysteps))

```


## Imputing missing values
To replace NA's we will use the mean of steps of each 5-minute interval.textplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext

```{r}

# add mean daily interval column to activity df, then replace NA's with this value
activity.noNAs <- merge(activity,activity_daily,by="interval")
# round to nearest whole number
activity.noNAs$meandailysteps <- round(activity.noNAs$meandailysteps, digits = 0)
# replace NA's with mean of daily interval
activity.noNAs$steps <- ifelse(is.na(activity.noNAs$steps),activity.noNAs$meandailysteps,activity.noNAs$steps)

activity.noNAs$meandailysteps <- NULL # remove mean column, not needed

activity.noNAs_by_day <- activity.noNAs %>% select (date,steps) %>% 
        filter(!is.na(steps)) %>% 
             group_by (date) %>% 
                summarise(totalstepsperday= sum(steps))

summary (activity.noNAs_by_day)


hist(activity.noNAs_by_day$totalstepsperday,
     breaks=seq(0,25000,by=2500),
         ylim=c(0,20),
            col="blue",
                main="Histogram of daily steps",
                    xlab="Steps",
                        ylab="Frequency",
                            border="red")

```



## STEP 3 -Are there differences in activity patterns between weekdays and weekends?
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
plaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintextplaintext
